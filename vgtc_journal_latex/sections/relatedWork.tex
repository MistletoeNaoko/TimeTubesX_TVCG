\section{Related work\label{sec:relatedWork}}
Our target blazar datasets are multi-dimensional (mD), semi-structured, and time-dependent.
This section reviews prior work in astronomical visualization and visual query systems for mD and time-series data. 


\subsection{Visualization for Astronomical Data}\label{sec:relatedAstronomy}
Most astronomers work on analyzing signals from distant celestial bodies measured from the Earth~\cite{Kent2017}. 
%Astronomers make much account of observing and analyzing signals from distant celestial bodies
%because they cannot travel just to see the bodies with their naked eyes~\cite{Kent2017}.
% Li et al.~\cite{Li2007} visualize positional and data-inherent uncertainties of large-scale 3D astronomical simulations.
% For multi-wavelength astronomical data, Li and Hanson~\cite{Li2008} propose a system for visual analysis across multiple datasets.
% %Li and Hanson~\cite{Li2008} tackle 3D visualization for multi-wavelength astronomical data from multiple data sources, which realizes easy visual analysis across multiple datasets.
% Baines et al.~\cite{Baines2017} develop a web-based data discovery portal, ESASky, for exploring multi-wavelength sky data.
% GalStamps~\cite{McCurdy2019} is a visual analytics tool for both real and simulated galaxy observations,
% which realizes analysis across multiple different visualization, such as scatterplots and parallel coordinate plots.
% Though many techniques have been developed for astronomical data, there are no other effective techniques for blazar observations, except for our early attempt~\cite{Fujishiro2018}.
ESASky~\cite{Baines2017} and OpenSpace~\cite{Bock2020} provide views for parts of the sky that are integrated from multiple data sources.
Almryde et al.~\cite{Almryde2016} visualize the temporal evolution of the position, mass, and radial velocity of dark matter halos. 
% Various types of telescopes are used to observe the sky or particular celestial bodies in different wavelengths 
% because visible light observation does not provide enough data to appreciate the nature of the universe.
% observing only visible light is not enough to appreciate the real nature of the universe.
Li et al.~\cite{Li2008} realize simple visual analysis across multi-wavelength datasets.
IGM-Vis~\cite{Burchett2019} is a visual analytics tool for quasar sightline data.
% propose 3D view for galaxies and quasar sightlines and 2D views for spectrum for the analysis of intergalactic medium and circumgalactic medium.
Some approaches~\cite{Haroz2008, Li2008, Preston2016, McCurdy2019, Burchett2019} provide linked-view visualization systems that allow users to explore multiple types of visualizations for deeper analyses.
Many techniques have been developed for the analysis of astronomical data, 
but typically, blazar researchers have used animated scatterplots (see Section~\ref{sec:VisualEncoding}) 
because there were no other effective techniques for blazar observations prior to our early attempt, TimeTubes~\cite{Fujishiro2018}.
% For more efficient data analysis with TimeTubesX, we introduce feature and pattern detection methods for blazar datasets, a part of which is an extension of our previous paper~\cite{Sawada2018}.

\subsection{Visual Queries}\label{sec:relatedFeature}
Visual query systems allow users to intuitively search for patterns of interest in their data.
%The two most common options are \emph{query-by-example} and \emph{query-by-sketch}.
%Query-by-example and query-by-sketch interfaces are powerful approaches to querying data intuitively. 
Query-by-example aims to find data samples that are similar to a user-specified example,
% However, they do not address how to find the initial interesting data samples. 
whereas query-by-sketch allows users to directly draw the shape of interest.
% , yet the techniques have to deal with the user-introduced uncertainties of sketches.

\textsf{Query-by-example.\ }
% QBE for univariate data
%In these systems, users select an example from their data, that serves as the query for the rest of the dataset.% excerpt a part of time series for their query.
Hochheiser and Shneiderman~\cite{Hochheiser2004} propose TimeSearcher, a visual exploration tool for time-series data. Users can select portions of timelines by using rectangular widgets~\cite{Buono2005, Buono2008}.
% such as Timeboxes~\cite{Buono2005} and Search Boxes~\cite{Buono2008}.
%where the users are allowed to select portions of timelines by putting boxes, termed Timeboxes~\cite{Buono2005} or Search Boxes~\cite{Buono2008}.
Holz and Feiner~\cite{Holz2009} propose a relaxed selection technique for time intervals through which users define the level of similarity either by the input speed or by spatial deviation from an original timeline.
The idea of detecting the input speed was adopted for our sketching interface.
However, these interactions are geared only toward univariate time-series data and are not appropriate for our mD blazar data.
%
%to allow ones to select a time interval and to define the level of similarity simultaneously
%by detecting either sketching speed or spatial deviation from an original timeline.
%Their interactions work effectively only for univariate time-series data.

% QBE for multivariate data
Query-by-example methods for mD data have also been proposed.
Martin and Ward~\cite{Martin2005} describe brushing techniques for visualizations,
such as scatterplots matrices and parallel coordinate plots.
Elmqvist et al. propose interactions for constructing visual queries with star plots~\cite{Elmqvist2007} and multiple scatterplots~\cite{Elmqvist2008}.
Scribble query~\cite{Nielsen2016} allows users to form visual queries by scribbling axes of parallel coordinate plots.
% introduces a touch interaction method for forming visual queries
% through parallel coordinate plots by scribbling axes. 
Several works have focused on unstructured mD datasets~\cite{Martin2005,Elmqvist2007,Nielsen2016}, 
%The techniques in \cite{Martin2005}, \cite{Elmqvist2007}, and \cite{Nielsen2016} effectively work for unstructured mD datasets, 
but they are not versatile enough to examine correlations among our idiosyncratic variables (see Section~\ref{sec:BlazarData}), and they do not support queries for structured time-series data.
The scatterplots by Martin and Ward~\cite{Martin2005} and Elmqvist et al.~\cite{Elmqvist2008} can be partially useful for structured data, but they cannot be applied to time-series data.

% QBS
\textsf{Query-by-sketch.\ } 
%Users may sketch the shape of interest for their query.
Early examples of query-by-sketch tools include QuerySketch~\cite{Wattenberg2001} for temporal databases and QueryLines~\cite{Ryall2005} for multiple timelines. 
%QuerySketch~\cite{Wattenberg2001} is a sketch-based visual query tool for a temporal database.
%QueryLines~\cite{Ryall2005} allows the users to draw a query involving soft constraints and preferences.
TimeSketch~\cite{Eichmann2015} supports pen- and touch-based query specification but focuses only on univariate time-series data.
% symbolic approximation
%Query-by-sketch interfaces have to handle ambiguities of hand-drawn sketches. 
To manage the ambiguities of hand-drawn sketches, several systems discretize the query and datasets into symbolic or quantized representations~\cite{Muthumanickam2016,ruta2019sax}.
%The input query and time series are discretized into symbolic representations to cope with uncertainties of a hand-drawn sketch in \cite{Muthumanickam2016} and \cite{ruta2019sax}.
%
Alternatively, Correll and Gleicher~\cite{Correll2016} define invariants for sketches. % to deal with uncertainties of sketches. 
Qetch~\cite{Mannino2018} provides a matching algorithm that takes human sketching errors into account.
Our query-by-sketch interface uses sketching interactions similar to those of Qetch~\cite{Mannino2018}.
% The sketching interactions of Qetch~\cite{Mannino2018} inspired our query-by-sketch interface.
Both techniques target univariate time-series data.
%
Shao et al.~\cite{Shao2014} introduce sketch-based queries for large sets of scatterplots,
in which the system supports users with shadow-drawing suggestions. %, which we use as an inspiration for our fact-driven querying\autoref{sec:factDrivenQuerying}.
The suggestions allow users to draw a pattern based on actual values rather than their imaginations.
We use this idea as inspiration for our fact-guided querying (see Section~\ref{sec:factDrivenQuerying}).
%users are allowed to draw a pattern with the help of shadow-drawing suggestions,
%due to which the input sketch is not just a fiction by the users but based on fact.
%It influences the concept of our fact-driven querying, as discussed in \autoref{sec:factDrivenQuerying}.
While these systems support querying structured mD data, they cannot be applied to time-series data.

% QBS for volume data
Several sketch-based techniques for multi-scalar volume data allow users to select regions of a 3D object through an ordinary 2D painting tool.
The techniques by Owada et al.~\cite{Owada2005} and Igarashi et al.~\cite{Igarashi2016} extract a plausible 3D region from the volume
by following contours or isosurfaces, respectively.
Tzeng et al.~\cite{Tzeng2003} present an method for specifying high-dimensional classification functions for the volume
by brushing regions of interest. % and those of uninterest.
BrainGazer~\cite{Bruckner2009} provides simple interactions for the selection of a region of interest in the volume
using drag-and-drop functionality.
% clicking on and dragging a 3D object. 
These techniques can only target multi-scalar volume data. 

\textsf{Combinations of query-by-example and query-by-sketch.\ }
Query-by-example techniques do not address how to find the initial data samples of interest, 
% users have to first identify an interesting data point in their dataset,
while query-by-sketch techniques must surmount the user-introduced ambiguities of sketches.
Combining both styles helps to resolve this trade-off, as addressed by 
Bernard et al.~\cite{Bernard2010} and Lee et al.~\cite{Lee2019}. 
The system formulated by Bernard et al.~\cite{Bernard2010} supports univariate time-series data, while the one by Lee et al.~\cite{Lee2019} supports unstructured time-series data.
% To get the best of both worlds, TimeTubesX supports automatic feature extraction as wells as query-by-example and query-by-sketch interactions.
To get the best of both worlds, TimeTubesX supports both types of querying interactions.
%
%To compensate these shortcomings, 
%we go together with both styles to build a new integrated feature extraction system 
%with both styles.

% because standard visualizations like scatterplots, star plots, parallel coordinate plots is not enough 
% for the astronomers to understand correlations among idiosyncratic variables (see Sec.~\ref{sec:BlazarData}) to build their query.


% % QBE for univariate data
% There are many query-by-example techniques which can deal with univariate datasets.
% Hochheiser and Shneiderman~\cite{Hochheiser2004} propose a visual exploration tool for time-series data, named TimeSearcher,
% where users are allowed to select portions of timeline by putting boxes, Timeboxes~\cite{Buono2005}.
% Search Box~\cite{Buono2008}, an augmented version of Timebox, allows users to change the shape of the selected pattern 
% and provides a series of characteristic patterns to prune timelines. 
% % SOMFlow~\cite{Sacha2018} is a visual analytic tool which can interactively refine clusters based on query-by-example using self-organizing maps.
% Holz and Feiner~\cite{Holz2009} propose a relaxed selection technique for time-series data.
% The technique allows users to select a time interval and define the level of similarity simultaneously
% by detecting either sketching speed or spatial deviation from an original timeline.
% These methods are effective only for univariate datasets, 
% so their interactions can not be directly applied to multivariate datasets.

% % QBE for multivariate data
% There also exist query-by-example methods for multivariate non-time-varying datasets.
% Martin and Ward~\cite{Martin2005} describe the design of brushing techniques for multi-dimensional data with various visualizations, 
% like scatterplot matrices, parallel coordinate plots, and the like.
% DataMeadow~\cite{Elmqvist2007} also provides interactions for constructing visual queries for multi-dimensional data 
% with star plots by adding filtering constraints to each axis of star plots. 
% Elmqvist et al.~\cite{Elmqvist2008} propose a new interface for interactively building queries for a multi-dimensional dataset 
% by providing smooth transition animation between scatterplots in a similar way to rolling a dice. 
% Scribble query, proposed by Nielsen et al.~\cite{Nielsen2016}, introduces a touch interaction 
% for visually forming queries for a multi-dimensional dataset
% through parallel coordinate plots by scribbling axes to select categories or ranges.
% They can deal with non-time-varying multivariate datasets, 
% but standard visualizations like scatterplots, star plots, parallel coordinate plots is not enough 
% for astronomers to understand correlations among idiosyncratic variables (see Sec.~\ref{sec:BlazarData}) to build their query.



% As detailed in Sec.~\ref{sec:BlazarData},
% in the target blazar datasets of TimeTubesX, 
% two structured polarization parameters describe linear polarization of the light
% and two retinal parameters explain the brightness and color.
% In other words, 

% Astrophysics can be said to be the ultimate remote sensing,

% Visualizations for simulated data have been extensively studied in astronomy.
% Haroz et al.~\cite{Haroz2008} visualize multiple simulation results,
% where they colorize particles to express uncertainties in time-varying cosmological particle data.
% Kahler et al.~\cite{Kahler2002a} render simulations of the evolution of the first star in the universe.
% The gas distribution is expressed by opacities, whereas temparature is by colors.
% Jensen et al.~\cite{Jensen2001} present a physical model of the night sky seen on the Earth.
% Genetti~\cite{Genetti2002} simulates and visualizes Orion Nebula from various viewpoints.
% Magnor et al.~\cite{Magnor2005} present an interactive visualization tool for realistically rendered dust distributions around illuminating stars.

% We present visualizations for observed or measured data in astronomy.
% McDonald and Montgomery~\cite{McDonald2012} visualize high-resolution laser altimeter data of the Moon.
% By utilizing a colormap optimized by a combination of hue and brightness,
% users are allowed to distinguish high and low altitude place.
% Additionally, the system enables users to measure the distance and slope of the lunar surface interactively.

% EASYSky visualizes multiple archives and allows users to visually identify the data source.
% OpenSpace~\cite{Bock2020} is an integrated environment for data from both observed and simulated data,
% to interactively explore the known universe.
% and supports research in astronomy and space science as well as science communication in educational situations.

% consisting of structured properties for the polarization of the light and retinal properties for the intensity and color.

% Feature extraction results in eliciting useful information from large or long-term data~\cite{Laxman2006}.
% Many methods for finding out patterns or outstanding time variations are proposed~\cite{WarrenLiao2005, Zhang2005, Rosner1983, Palshikar2009}.
% These methods may partially be effective for blazar observation datasets,
% however, the astronomers have to carefully analyze correlations among variables 
% to inspect whether the time interval is notable or not
% even after applying such methods.
% Regarding flares, only applying peak detection methods or outlier detection methods is insufficient  
% because the intensity of a blazar always varies finely in the short term.
% % Regarding rotation events of polarization, 
% % astronomers analyze a time variation of the polarization angle.
% To find out rotations of the polarization, 
% the astronomers manually track time variation of the polarization angle ($PA$), given as Eqn.~(\ref{equ:PA}), 
% as explained in analysis examples of previous reports~\cite{Ikejiri2011, Uemura2017},
% where $PA$ variation identifies only rotations around the origin. %of the Stokes plane.
% Therefore, a new method is desired, which realizes easy access to and verification of candidates of remarkable time intervals.

% In query-by-example, users excerpt a part of time series for their query, 
% whereas in query-by-sketch, they sketch the shape of interest for their query.
% The following parts present prior research challenges in each of the styles.

% The following parts of this section review past attempts to visually specify a query 
% to present motivations for our work.

% Many query-by-example techniques can deal with univariate time-series datasets.
% Search Box~\cite{Buono2008}, an augmented version of Timebox, allows users to change the shape of the selected pattern 
% and provides a series of characteristic patterns to prune timelines.

% DataMeadow~\cite{Elmqvist2007} also provides interactions for constructing visual queries for mD data 
% with star plots by adding filtering constraints to each axis of star plots. 
% Elmqvist et al.~\cite{Elmqvist2008} propose a new interface for interactively building queries for mD data 
% by providing smooth transition animation between scatterplots in a way similar to rolling a dice.

% but obviously, they cannot be applied to time-series data, either.

% Many sketch-based querying systems are developed for univariate time-series data.

% where users are allowed to draw the shape of a pattern for a query.
% It simply computes Euclidean distance between a sketch and time series in a database.
% It prunes plots according to the soft constraints and orders the selected plots by the extent to which they satisfy preferences. 
% It computes similarities between a query and time series in three different distance metrics:
% Euclidean distance, dynamic time warping~\cite{Berndt1994}, and spatial assembling distance~\cite{Chen2007},
% and creates a human-annotated ranking based on crowd-sourcing evaluations.
% According to their experimental results, the dynamic time warping produces the closest ranking to the human-annotated ranking. 
% Therefore, we choose the dynamic time warping in the similarity measurement process in the proposed visual query.

% A single sketch can be produced under different mental models.
% Comparing a user-drawn sketch and time series in a symbolic space can conduct a fuzzy pattern search.
% Muthumanickam et al.~\cite{Muthumanickam2016} define shape grammars composed of thirteen basic elementary shapes 
% to approximate data with the predefined symbols.
% Symbolic Aggregate approXimation (SAX)~\cite{Lin2007} is a symbolic representation for time series.
% SAX Navigator, proposed by Ruta et al.~\cite{ruta2019sax}, is a visual exploration tool for a large collection of univariate time series based on SAX representations.
% Users query a pattern of interest as a SAX letter sequence by clicking a cell on a grid. 
% Other approaches to deal with uncertainties of sketch
% The prototype query system, named QuerySketch, can take account of the invariants in the matching process.
% present Qetch,
% which is a tool to query time series based on a user-drawn sketch as well.
% It provides a matching algorithm taking human sketching errors into account.
% The background algorithms of QuerySketch and Qetch take uncertainties of the sketch into account.
% To deal with uncertainties of sketches, Shao gives suggestions for drawing 

% Owada et al.~\cite{Owada2005} propose a simple and intuitive interface 
% for volume segmentation, named Volume Catcher.
% Users trace a contour of the volume and then the system automatically extracts a plausible 3D region inside the input stroke.
% Igarashi et al.~\cite{Igarashi2016} propose an environment 
% where users are allowed to select a region of the volume by interactions like an ordinary 2D painting tool.
% The main difference between the two systems is 
% The sketching interactions in~\cite{Owada2005} work on a contour of the volume
% while those in~\cite{Igarashi2016} work on isosurfaces in the volume.
% which they do not with simple sketching interactions.
% They need to paint only on a couple of slices of the volume to classify the entire volume.% unlike the semi-structured and time-dependent mD data in TimeTubesX.
% but they inspire the interactions for selecting a part of a 3D tube in query-by-example, as detailed in Sec.~\ref{sec:QBE}.

% The visual query system in~\cite{Bernard2010} enables users to decide whether to sketch a query by hand or 
% to pick up an example pattern from a dataset, predefined shapes, or a visual catalog of time series provided by the self-organizing map algorithm.
% On the other hand, 
% the system in~\cite{Lee2019} allows users to utilize a resulting visualization as an input pattern and to draw a sketch with reference to an actual data pattern like the shadow-drawing suggestions in~\cite{Shao2014}.
% However, these are also only for univariate datasets.